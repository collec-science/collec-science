\section{Description des tables}

\subsection{Schema col}
\subsubsection{Tables}
\paragraph{barcode}
Models of barcodes usable

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type & Not null & Key & Comment \\
\hline
barcode\_id & integer & X & X & \\
barcode\_name & character varying & X &  & Name of the model\\
barcode\_code & character varying & X &  & Value of the barcode used by the generating application, if occures. Default value: QR for QRcode\\
\hline
\end{tabular}
\paragraph{Referenced by}
barcode\_id: col.label (barcode\_id)

\paragraph{booking}
Table of object's bookings

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type & Not null & Key & Comment \\
\hline
booking\_id & integer & X & X & \\
uid & integer & X &  & \\
booking\_date & timestamp without time zone & X &  & Date of booking\\
date\_from & timestamp without time zone & X &  & Date-time of booking start\\
date\_to & timestamp without time zone & X &  & Date-time of booking end\\
booking\_comment & character varying &  &  & Comment\\
booking\_login & character varying & X &  & Login used to perform the reservation\\
\hline
\end{tabular}
\paragraph{References}
uid: col.object (uid)

\paragraph{borrower}
List of borrowers

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type & Not null & Key & Comment \\
\hline
borrower\_id & integer & X & X & \\
borrower\_name & character varying & X &  & \\
borrower\_address & character varying &  &  & Address of the borrower\\
borrower\_phone & character varying &  &  & Phone of the contact of the borrower\\
laboratory\_code & character varying &  &  & Laboratory code of the borrower\\
borrower\_mail & character varying &  &  & Mail of the borrower\\
\hline
\end{tabular}
\paragraph{Referenced by}
borrower\_id: col.borrowing (borrower\_id)

\paragraph{borrowing}
List of borrowings

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type & Not null & Key & Comment \\
\hline
borrowing\_id & integer & X & X & \\
borrowing\_date & timestamp without time zone & X &  & Date of the borrowing\\
expected\_return\_date & timestamp without time zone &  &  & Expected return date of the object\\
uid & integer & X &  & \\
borrower\_id & integer & X &  & \\
return\_date & timestamp without time zone &  &  & Date of return of the object\\
\hline
\end{tabular}
\paragraph{References}
borrower\_id: col.borrower (borrower\_id)

uid: col.object (uid)

\paragraph{campaign}
List of sampling campaigns

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type & Not null & Key & Comment \\
\hline
campaign\_id & integer & X & X & \\
referent\_id & integer &  &  & \\
campaign\_name & character varying & X &  & Name of the campaign\\
campaign\_from & timestamp without time zone &  &  & Date of start of the campaign\\
campaign\_to & timestamp without time zone &  &  & date of end of the campaign\\
\hline
\end{tabular}
\paragraph{References}
referent\_id: col.referent (referent\_id)

\paragraph{Referenced by}
campaign\_id: col.campaign\_regulation (campaign\_id)

campaign\_id: col.document (campaign\_id)

campaign\_id: col.sample (campaign\_id)

\paragraph{campaign\_regulation}
List of regulations attached to a campaign

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type & Not null & Key & Comment \\
\hline
campaign\_regulation\_id & integer & X & X & \\
campaign\_id & integer & X &  & \\
regulation\_id & integer & X &  & \\
authorization\_number & character varying &  &  & Number of the authorization\\
authorization\_date & timestamp without time zone &  &  & Date of the authorization\\
\hline
\end{tabular}
\paragraph{References}
campaign\_id: col.campaign (campaign\_id)

regulation\_id: col.regulation (regulation\_id)

\paragraph{collection}
List of all collections into the database

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type & Not null & Key & Comment \\
\hline
collection\_id & integer & X & X & \\
collection\_name & character varying & X &  & \\
referent\_id & integer &  &  & \\
allowed\_import\_flow & boolean &  &  & Allow an external source to update a collection\\
allowed\_export\_flow & boolean &  &  & Allow interrogation requests from external sources\\
public\_collection & boolean &  &  & Set if a collection can be requested without authentication\\
collection\_keywords & character varying &  &  & List of keywords, separed by a comma\\
collection\_displayname & character varying &  &  & Name used to communicate from the collection, in export module by example\\
license\_id & integer &  &  & \\
\hline
\end{tabular}
\paragraph{References}
license\_id: col.license (license\_id)

referent\_id: col.referent (referent\_id)

\paragraph{Referenced by}
collection\_id: col.lot (collection\_id)

collection\_id: col.samplesearch (collection\_id)

collection\_id: col.sampling\_place (collection\_id)

collection\_id: col.collection\_group (collection\_id)

collection\_id: col.protocol (collection\_id)

collection\_id: col.sample (collection\_id)

\paragraph{collection\_group}
Table of project approvals

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type & Not null & Key & Comment \\
\hline
collection\_id & integer & X & X & \\
aclgroup\_id & integer & X & X & \\
\hline
\end{tabular}
\paragraph{References}
collection\_id: col.collection (collection\_id)

aclgroup\_id: gacl.aclgroup (aclgroup\_id)

\paragraph{container}
Liste of containers

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type & Not null & Key & Comment \\
\hline
container\_id & integer & X & X & \\
uid & integer & X &  & \\
container\_type\_id & integer & X &  & \\
\hline
\end{tabular}
\paragraph{References}
container\_type\_id: col.container\_type (container\_type\_id)

uid: col.object (uid)

\paragraph{Referenced by}
container\_id: col.movement (container\_id)

\paragraph{container\_family}
General family of containers

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type & Not null & Key & Comment \\
\hline
container\_family\_id & integer & X & X & \\
container\_family\_name & character varying & X &  & \\
\hline
\end{tabular}
\paragraph{Referenced by}
container\_family\_id: col.container\_type (container\_family\_id)

\paragraph{container\_type}
Table of types of containers

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type & Not null & Key & Comment \\
\hline
container\_type\_id & integer & X & X & \\
container\_type\_name & character varying & X &  & \\
container\_family\_id & integer & X &  & \\
clp\_classification & character varying &  &  & Risk classification according to the European CLP directive\\
container\_type\_description & character varying &  &  & Long description\\
storage\_condition\_id & integer &  &  & \\
storage\_product & character varying &  &  & Product used for storage (formol, alcohol...)\\
label\_id & integer &  &  & \\
columns & integer & X &  & Number of storage columns in the container\\
lines & integer & X &  & Number of storage lines in the container\\
first\_line & character varying & X &  & Place of the first line:
T: top
B: bottom\\
nb\_slots\_max & integer &  &  & Number maximum of slots in the container\\
first\_column & character varying &  &  & Place of the first column: 
L: left
R: Right\\
\hline
\end{tabular}
\paragraph{References}
container\_family\_id: col.container\_family (container\_family\_id)

label\_id: col.label (label\_id)

storage\_condition\_id: col.storage\_condition (storage\_condition\_id)

\paragraph{Referenced by}
container\_type\_id: col.container (container\_type\_id)

container\_type\_id: col.sample\_type (container\_type\_id)

\paragraph{country}
List of the countries

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type & Not null & Key & Comment \\
\hline
country\_id & integer & X & X & Numeric ISO code of the country\\
country\_name & character varying & X &  & Name of the country\\
country\_code2 & character varying(2) & X &  & Code of the country, on 2 positions\\
country\_code3 & character varying(3) &  &  & Code of the country, on 3 positions\\
\hline
\end{tabular}
\paragraph{Referenced by}
country\_id: col.sample (country\_id)

country\_id: col.sampling\_place (country\_id)

country\_id: col.sample (country\_origin\_id)

\paragraph{dataset\_column}
List of columns included into the dataset

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type & Not null & Key & Comment \\
\hline
dataset\_column\_id & integer & X & X & \\
dataset\_template\_id & integer & X &  & \\
column\_name & character varying & X &  & Name of the column into the database\\
export\_name & character varying & X &  & Name of the column into the export file\\
subfield\_name & character varying &  &  & Name of the field if it into the metadata description of the sample or secondary identifier, etc.\\
translator\_id & integer &  &  & \\
column\_order & smallint &  &  & order of displaying in the exported file\\
mandatory & boolean &  &  & Is the content of the column is mandatory to export data?\\
default\_value & character varying &  &  & Default value, if the value is not filled in\\
date\_format & character varying &  &  & Export date format, in php notation. Example: d/m/Y H:i:s for 25/12/2020 17:15:00\\
search\_order & smallint &  &  & To search a sample, order of the current field to trigger the search\\
\hline
\end{tabular}
\paragraph{References}
dataset\_template\_id: col.dataset\_template (dataset\_template\_id)

translator\_id: col.translator (translator\_id)

\paragraph{dataset\_template}
List of templates of dataset

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type & Not null & Key & Comment \\
\hline
dataset\_template\_id & integer & X & X & \\
dataset\_template\_name & character varying & X &  & Name of the template\\
export\_format\_id & integer & X &  & \\
dataset\_type\_id & integer & X &  & \\
only\_last\_document & boolean &  &  & If type document, specify if only the last document attached to a sample is exported\\
separator & character varying &  &  & Separator used in csv files (tab , ;)\\
filename & character varying & X &  & File name generated, with extension\\
xmlroot & character varying &  &  & xml root to generate\\
xmlnodename & character varying &  &  & Name of a node in a xml file, for list of samples by example\\
xslcontent & character varying &  &  & Transformation of the generated xml to create a specific xml file\\
\hline
\end{tabular}
\paragraph{References}
dataset\_type\_id: col.dataset\_type (dataset\_type\_id)

export\_format\_id: col.export\_format (export\_format\_id)

\paragraph{Referenced by}
dataset\_template\_id: col.dataset\_column (dataset\_template\_id)

dataset\_template\_id: col.export\_dataset (dataset\_template\_id)

\paragraph{dataset\_type}
Origine of the dataset: sample, collection, document

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type & Not null & Key & Comment \\
\hline
dataset\_type\_id & integer & X & X & \\
dataset\_type\_name & character varying & X &  & \\
fields & json &  &  & List of allowed fields of the database (json array)\\
\hline
\end{tabular}
\paragraph{Referenced by}
dataset\_type\_id: col.dataset\_template (dataset\_type\_id)

\paragraph{dbparam}
Table of parameters intrinsically associated to the instance

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type & Not null & Key & Comment \\
\hline
dbparam\_id & integer & X & X & \\
dbparam\_name & character varying & X &  & Name of the parameter\\
dbparam\_value & character varying &  &  & Value of the parameter\\
\hline
\end{tabular}
\paragraph{dbversion}
Table of the database versions

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type & Not null & Key & Comment \\
\hline
dbversion\_id & integer & X & X & \\
dbversion\_number & character varying & X &  & Number of the version\\
dbversion\_date & timestamp without time zone & X &  & Date of the version\\
\hline
\end{tabular}
\paragraph{document}
Numeric docs associated to an objet or a campaign

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type & Not null & Key & Comment \\
\hline
document\_id & integer & X & X & \\
uid & integer &  &  & \\
mime\_type\_id & integer & X &  & \\
document\_import\_date & timestamp without time zone & X &  & Import date into the database\\
document\_name & character varying & X &  & Original name\\
document\_description & character varying &  &  & Description\\
data & bytea &  &  & Binary content (object imported)\\
thumbnail & bytea &  &  & Thumbnail in PNG format ( only for pdf, jpg or png docs)\\
size & integer &  &  & Size of downloaded file\\
document\_creation\_date & timestamp without time zone &  &  & Create date of the document (date of photo shooting, for example)\\
campaign\_id & integer &  &  & \\
uuid & uuid & X &  & \\
\hline
\end{tabular}
\paragraph{References}
campaign\_id: col.campaign (campaign\_id)

mime\_type\_id: col.mime\_type (mime\_type\_id)

uid: col.object (uid)

\paragraph{event}
Table of events

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type & Not null & Key & Comment \\
\hline
event\_id & integer & X & X & \\
uid & integer & X &  & \\
event\_date & timestamp without time zone & X &  & Date-time of the event\\
event\_type\_id & integer & X &  & \\
still\_available & character varying &  &  & still available content in the object, after the event\\
event\_comment & character varying &  &  & Comment\\
\hline
\end{tabular}
\paragraph{References}
event\_type\_id: col.event\_type (event\_type\_id)

uid: col.object (uid)

\paragraph{event\_type}
Event types table

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type & Not null & Key & Comment \\
\hline
event\_type\_id & integer & X & X & \\
event\_type\_name & character varying & X &  & Name of the type of event\\
is\_sample & boolean & X &  & The event is applicable to the samples\\
is\_container & boolean & X &  & The event is applicable to the containers\\
\hline
\end{tabular}
\paragraph{Referenced by}
event\_type\_id: col.event (event\_type\_id)

\paragraph{export}
List of exports processed

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type & Not null & Key & Comment \\
\hline
export\_id & integer & X & X & \\
lot\_id & integer & X &  & \\
export\_date & timestamp without time zone &  &  & Date of last execution of the export\\
export\_template\_id & integer & X &  & \\
\hline
\end{tabular}
\paragraph{References}
export\_template\_id: col.export\_template (export\_template\_id)

lot\_id: col.lot (lot\_id)

\paragraph{export\_dataset}
List of datasets embedded into the template of export

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type & Not null & Key & Comment \\
\hline
export\_template\_id & integer & X & X & \\
dataset\_template\_id & integer & X & X & \\
\hline
\end{tabular}
\paragraph{References}
dataset\_template\_id: col.dataset\_template (dataset\_template\_id)

export\_template\_id: col.export\_template (export\_template\_id)

\paragraph{export\_format}
List of formats of export

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type & Not null & Key & Comment \\
\hline
export\_format\_id & integer & X & X & \\
export\_format\_name & character varying & X &  & \\
\hline
\end{tabular}
\paragraph{Referenced by}
export\_format\_id: col.dataset\_template (export\_format\_id)

\paragraph{export\_model}
Structure of an export/import of table data

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type & Not null & Key & Comment \\
\hline
export\_model\_id & integer & X & X & \\
export\_model\_name & character varying & X &  & Name of the structure of export\\
pattern & json &  &  & Pattern of the export/import.
Structure:
[{technicalKey:string,businessKey:string,tableName:string,tableAlias:string,children[table1,table2],parentKey:string,secondaryParentKey:string}]\\
target & character varying &  &  & Main table targetted\\
\hline
\end{tabular}
\paragraph{export\_template}
List of models of export

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type & Not null & Key & Comment \\
\hline
export\_template\_id & integer & X & X & \\
export\_template\_name & character varying & X &  & Name of the model\\
export\_template\_description & character varying &  &  & Description of the model\\
export\_template\_version & character varying &  &  & Version of the model, if necessary\\
is\_zipped & boolean &  &  & Specify if the generated files must be zipped\\
filename & character varying & X &  & Name of the file generated\\
\hline
\end{tabular}
\paragraph{Referenced by}
export\_template\_id: col.export (export\_template\_id)

export\_template\_id: col.export\_dataset (export\_template\_id)

\paragraph{identifier\_type}
Table of identifier types

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type & Not null & Key & Comment \\
\hline
identifier\_type\_id & integer & X & X & \\
identifier\_type\_name & character varying & X &  & Textual name of the identifier\\
identifier\_type\_code & character varying &  &  & Identifier code, used in the labels\\
used\_for\_search & boolean & X &  & Is the identifier usable for barcode searches?\\
\hline
\end{tabular}
\paragraph{Referenced by}
identifier\_type\_id: col.object\_identifier (identifier\_type\_id)

\paragraph{label}
Table of label models

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type & Not null & Key & Comment \\
\hline
label\_id & integer & X & X & \\
label\_name & character varying & X &  & Name of the model\\
label\_xsl & character varying & X &  & XSL content used by FOP transformation (https://xmlgraphics.apache.org/fop/)\\
label\_fields & character varying & X &  & List of fields incorporated in the QRCODE\\
metadata\_id & integer &  &  & Model of the metadata template associated with this label\\
identifier\_only & boolean & X &  & true: the qrcode contains only a business identifier\\
barcode\_id & integer & X &  & \\
\hline
\end{tabular}
\paragraph{References}
barcode\_id: col.barcode (barcode\_id)

metadata\_id: col.metadata (metadata\_id)

\paragraph{Referenced by}
label\_id: col.container\_type (label\_id)

\paragraph{license}
List of licenses usable to communicate informations on the collections

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type & Not null & Key & Comment \\
\hline
license\_id & integer & X & X & \\
license\_name & character varying & X &  & Name of the license\\
license\_url & character varying &  &  & Link of download of the text of the license\\
\hline
\end{tabular}
\paragraph{Referenced by}
license\_id: col.collection (license\_id)

\paragraph{lot}
List of lots of export

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type & Not null & Key & Comment \\
\hline
lot\_id & integer & X & X & \\
collection\_id & integer &  &  & \\
lot\_date & timestamp without time zone & X &  & Date of creation of the lot\\
\hline
\end{tabular}
\paragraph{References}
collection\_id: col.collection (collection\_id)

\paragraph{Referenced by}
lot\_id: col.export (lot\_id)

lot\_id: col.lot\_sample (lot\_id)

\paragraph{lot\_sample}
List of samples associated into a lot

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type & Not null & Key & Comment \\
\hline
lot\_id & integer & X & X & \\
sample\_id & integer & X & X & \\
\hline
\end{tabular}
\paragraph{References}
lot\_id: col.lot (lot\_id)

sample\_id: col.sample (sample\_id)

\paragraph{metadata}
Table of metadata usable with types of samples

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type & Not null & Key & Comment \\
\hline
metadata\_id & integer & X & X & \\
metadata\_name & character varying & X &  & Name of the metadata set\\
metadata\_schema & json &  &  & JSON schema of the metadata form\\
\hline
\end{tabular}
\paragraph{Referenced by}
metadata\_id: col.label (metadata\_id)

metadata\_id: col.sample\_type (metadata\_id)

\paragraph{mime\_type}
Mime types of imported files

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type & Not null & Key & Comment \\
\hline
mime\_type\_id & integer & X & X & \\
extension & character varying & X &  & File extension\\
content\_type & character varying & X &  & Official mime type\\
\hline
\end{tabular}
\paragraph{Referenced by}
mime\_type\_id: col.document (mime\_type\_id)

\paragraph{movement}
Records of objects movements

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type & Not null & Key & Comment \\
\hline
movement\_id & integer & X & X & \\
uid & integer & X &  & \\
container\_id & integer &  &  & \\
movement\_type\_id & integer & X &  & \\
movement\_date & timestamp without time zone & X &  & Date-time of the movement\\
storage\_location & character varying &  &  & Place of the object in the container, in textual form\\
login & character varying & X &  & Name of the operator who performed the operation\\
movement\_comment & character varying &  &  & Comment\\
movement\_reason\_id & integer &  &  & \\
column\_number & integer & X &  & Number of the storage column in the container\\
line\_number & integer & X &  & Number of the storage line in the container\\
\hline
\end{tabular}
\paragraph{References}
container\_id: col.container (container\_id)

movement\_reason\_id: col.movement\_reason (movement\_reason\_id)

movement\_type\_id: col.movement\_type (movement\_type\_id)

uid: col.object (uid)

\paragraph{movement\_reason}
List of the reasons of the movement

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type & Not null & Key & Comment \\
\hline
movement\_reason\_id & integer & X & X & \\
movement\_reason\_name & character varying & X &  & \\
\hline
\end{tabular}
\paragraph{Referenced by}
movement\_reason\_id: col.movement (movement\_reason\_id)

\paragraph{movement\_type}
Type de mouvement

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type & Not null & Key & Comment \\
\hline
movement\_type\_id & integer & X & X & \\
movement\_type\_name & character varying & X &  & \\
\hline
\end{tabular}
\paragraph{Referenced by}
movement\_type\_id: col.movement (movement\_type\_id)

movement\_type\_id: col.subsample (movement\_type\_id)

\paragraph{multiple\_type}
Table of categories of potential sub-sampling (unit, quantity, percentage, etc.)

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type & Not null & Key & Comment \\
\hline
multiple\_type\_id & integer & X & X & \\
multiple\_type\_name & character varying & X &  & \\
\hline
\end{tabular}
\paragraph{Referenced by}
multiple\_type\_id: col.sample\_type (multiple\_type\_id)

\paragraph{object}
Table of objects

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type & Not null & Key & Comment \\
\hline
uid & integer & X & X & Unique identifier in the database of all objects\\
identifier & character varying &  &  & Main working identifier\\
wgs84\_x & double precision &  &  & GPS longitude, in decimal form\\
wgs84\_y & double precision &  &  & GPS latitude, in decimal form\\
object\_status\_id & integer &  &  & \\
referent\_id & integer &  &  & \\
change\_date & timestamp without time zone & X &  & Technical date of changement of the object\\
uuid & uuid & X &  & UUID of the object\\
trashed & boolean &  &  & If the object is trashed before completly destroyed ?\\
location\_accuracy & double precision &  &  & Location accuracy of the object, in meters\\
geom & geography(Point,4326) &  &  & Geographic point generate from wgs84\_x and wgs84\_y\\
object\_comment & character varying &  &  & Comment on the object (sample or container)\\
\hline
\end{tabular}
\paragraph{References}
object\_status\_id: col.object\_status (object\_status\_id)

referent\_id: col.referent (referent\_id)

\paragraph{Referenced by}
uid: col.booking (uid)

uid: col.container (uid)

uid: col.document (uid)

uid: col.event (uid)

uid: col.borrowing (uid)

uid: col.object\_identifier (uid)

uid: col.sample (uid)

uid: col.movement (uid)

\paragraph{object\_identifier}
Table of complementary identifiers

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type & Not null & Key & Comment \\
\hline
object\_identifier\_id & integer & X & X & \\
uid & integer & X &  & \\
identifier\_type\_id & integer & X &  & \\
object\_identifier\_value & character varying & X &  & Identifier value\\
\hline
\end{tabular}
\paragraph{References}
identifier\_type\_id: col.identifier\_type (identifier\_type\_id)

uid: col.object (uid)

\paragraph{object\_status}
Table of types of status

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type & Not null & Key & Comment \\
\hline
object\_status\_id & integer & X & X & \\
object\_status\_name & character varying & X &  & \\
\hline
\end{tabular}
\paragraph{Referenced by}
object\_status\_id: col.object (object\_status\_id)

\paragraph{operation}
List of operations attached to a protocol

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type & Not null & Key & Comment \\
\hline
operation\_id & integer & X & X & \\
protocol\_id & integer & X &  & \\
operation\_name & character varying & X &  & \\
operation\_order & integer &  &  & Order to perform the operation in the protocol\\
operation\_version & character varying &  &  & Version of the operation\\
last\_edit\_date & timestamp without time zone &  &  & Last edit date of the operation\\
\hline
\end{tabular}
\paragraph{References}
protocol\_id: col.protocol (protocol\_id)

\paragraph{Referenced by}
operation\_id: col.sample\_type (operation\_id)

\paragraph{printer}
Table of printers directly managed by the server

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type & Not null & Key & Comment \\
\hline
printer\_id & integer & X & X & \\
printer\_name & character varying & X &  & Usual name of the printer, displayed in the forms\\
printer\_queue & character varying & X &  & Name of the printer known by the operating system of the server\\
printer\_server & character varying &  &  & Server address, if the printer is not connected at the localhost\\
printer\_user & character varying &  &  & User used to print, if necessary\\
printer\_comment & character varying &  &  & Comment\\
\hline
\end{tabular}
\paragraph{protocol}
List of protocols

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type & Not null & Key & Comment \\
\hline
protocol\_id & integer & X & X & \\
protocol\_name & character varying & X &  & Name of the protocol\\
protocol\_file & bytea &  &  & PDF description of the protocol\\
protocol\_year & smallint &  &  & Year of the protocol\\
protocol\_version & character varying & X &  & Version of the protocol\\
collection\_id & integer &  &  & \\
authorization\_number & character varying &  &  & Number of the prelevement authorization\\
authorization\_date & timestamp without time zone &  &  & Date of the prelevement authorization\\
\hline
\end{tabular}
\paragraph{References}
collection\_id: col.collection (collection\_id)

\paragraph{Referenced by}
protocol\_id: col.operation (protocol\_id)

\paragraph{referent}
Table of sample referents

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type & Not null & Key & Comment \\
\hline
referent\_id & integer & X & X & \\
referent\_name & character varying & X &  & Name, firstname-lastname or department name\\
referent\_email & character varying &  &  & Email for contact\\
address\_name & character varying &  &  & Name for postal address\\
address\_line2 & character varying &  &  & second line in postal address\\
address\_line3 & character varying &  &  & third line in postal address\\
address\_city & character varying &  &  & ZIPCode and City in postal address\\
address\_country & character varying &  &  & Country in postal address\\
referent\_phone & character varying &  &  & Contact phone\\
referent\_firstname & character varying &  &  & Firstname of the referent\\
academical\_directory & character varying &  &  & Academical directory used to identifier the referent, as https://orcid.org or https://www.researchgate.net\\
academical\_link & character varying &  &  & Link used to identify the referent, as https://orcid.org/0000-0003-4207-4107\\
\hline
\end{tabular}
\paragraph{Referenced by}
referent\_id: col.collection (referent\_id)

referent\_id: col.campaign (referent\_id)

referent\_id: col.object (referent\_id)

\paragraph{regulation}
Table of regulations

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type & Not null & Key & Comment \\
\hline
regulation\_id & integer & X & X & \\
regulation\_name & character varying & X &  & Name of the regulation\\
regulation\_comment & character varying &  &  & regulatory clarity\\
\hline
\end{tabular}
\paragraph{Referenced by}
regulation\_id: col.campaign\_regulation (regulation\_id)

\paragraph{request}
Request table in database

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type & Not null & Key & Comment \\
\hline
request\_id & integer & X & X & \\
create\_date & timestamp without time zone & X &  & Date of create of the request\\
last\_exec & timestamp without time zone &  &  & Date of the last execution\\
title & character varying & X &  & Title of the request\\
body & character varying & X &  & Body of the request. Don't begin it by SELECT, which will be added automatically\\
login & character varying & X &  & Login of the creator of the request\\
datefields & character varying &  &  & List of the date fields used in the request, separated by a comma, for format it\\
\hline
\end{tabular}
\paragraph{sample}
Table of samples

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type & Not null & Key & Comment \\
\hline
sample\_id & integer & X & X & \\
uid & integer & X &  & \\
collection\_id & integer & X &  & \\
sample\_type\_id & integer & X &  & \\
sample\_creation\_date & timestamp without time zone & X &  & Creation date of the record in the database\\
sampling\_date & timestamp without time zone &  &  & Creation date of the physical sample or date of sampling\\
parent\_sample\_id & integer &  &  & \\
multiple\_value & double precision &  &  & \\
sampling\_place\_id & integer &  &  & \\
dbuid\_origin & character varying &  &  & Reference used in the original database, under the form db:uid. Used for read the labels created in others instances\\
metadata & json &  &  & Metadata associated with the sample, in JSON format\\
expiration\_date & timestamp without time zone &  &  & Date of expiration of the sample. After this date, the sample is not usable\\
campaign\_id & integer &  &  & \\
country\_id & integer &  &  & \\
country\_origin\_id & integer &  &  & \\
\hline
\end{tabular}
\paragraph{References}
campaign\_id: col.campaign (campaign\_id)

collection\_id: col.collection (collection\_id)

country\_id: col.country (country\_id)

country\_origin\_id: col.country (country\_id)

uid: col.object (uid)

parent\_sample\_id: col.sample (sample\_id)

sample\_type\_id: col.sample\_type (sample\_type\_id)

sampling\_place\_id: col.sampling\_place (sampling\_place\_id)

\paragraph{Referenced by}
sample\_id: col.lot\_sample (sample\_id)

sample\_id: col.sample (parent\_sample\_id)

sample\_id: col.subsample (sample\_id)

\paragraph{sample\_type}
Table of the types of samples

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type & Not null & Key & Comment \\
\hline
sample\_type\_id & integer & X & X & \\
sample\_type\_name & character varying & X &  & Name of the type\\
container\_type\_id & integer &  &  & \\
multiple\_type\_id & integer &  &  & \\
multiple\_unit & character varying &  &  & Name of the unit used  to qualify the number of sub-samples (ml, number, g, etc.)\\
metadata\_id & integer &  &  & \\
operation\_id & integer &  &  & \\
identifier\_generator\_js & character varying &  &  & Javascript function code used to automaticaly generate a working identifier from the intered information\\
sample\_type\_description & character varying &  &  & Description of the type of sample\\
\hline
\end{tabular}
\paragraph{References}
container\_type\_id: col.container\_type (container\_type\_id)

metadata\_id: col.metadata (metadata\_id)

multiple\_type\_id: col.multiple\_type (multiple\_type\_id)

operation\_id: col.operation (operation\_id)

\paragraph{Referenced by}
sample\_type\_id: col.sample (sample\_type\_id)

\paragraph{samplesearch}
List of sample saved search

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type & Not null & Key & Comment \\
\hline
samplesearch\_id & integer & X &  & \\
samplesearch\_name & character varying & X &  & Name of the search parameters\\
samplesearch\_data & json &  &  & List of all research parameters\\
samplesearch\_login & character varying &  &  & Login of the creator\\
collection\_id & integer &  &  & \\
\hline
\end{tabular}
\paragraph{References}
collection\_id: col.collection (collection\_id)

\paragraph{sampling\_place}
Table of sampling places

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type & Not null & Key & Comment \\
\hline
sampling\_place\_id & integer & X & X & \\
sampling\_place\_name & character varying & X &  & Name of the sampling place\\
collection\_id & integer &  &  & Collection of rattachment\\
sampling\_place\_code & character varying &  &  & Working code of the station\\
sampling\_place\_x & double precision &  &  & Longitude of the station, in WGS84\\
sampling\_place\_y & double precision &  &  & Latitude of the station, in WGS84\\
country\_id & integer &  &  & \\
\hline
\end{tabular}
\paragraph{References}
collection\_id: col.collection (collection\_id)

country\_id: col.country (country\_id)

\paragraph{Referenced by}
sampling\_place\_id: col.sample (sampling\_place\_id)

\paragraph{storage\_condition}
Table of the conditions of storage

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type & Not null & Key & Comment \\
\hline
storage\_condition\_id & integer & X & X & \\
storage\_condition\_name & character varying & X &  & \\
\hline
\end{tabular}
\paragraph{Referenced by}
storage\_condition\_id: col.container\_type (storage\_condition\_id)

\paragraph{subsample}
Table of sub-sample takes and returns

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type & Not null & Key & Comment \\
\hline
subsample\_id & integer & X & X & \\
sample\_id & integer & X &  & \\
subsample\_date & timestamp without time zone & X &  & Date-time of the operation\\
movement\_type\_id & integer & X &  & \\
subsample\_quantity & double precision &  &  & Quantity taken or returned\\
subsample\_comment & character varying &  &  & Comment on this operation\\
subsample\_login & character varying & X &  & Login of the user who perform this operation\\
\hline
\end{tabular}
\paragraph{References}
movement\_type\_id: col.movement\_type (movement\_type\_id)

sample\_id: col.sample (sample\_id)

\paragraph{translator}
Table of translator of values

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type & Not null & Key & Comment \\
\hline
translator\_id & integer & X & X & \\
translator\_name & character varying & X &  & \\
translator\_data & json &  &  & List of translations under the form term\_in\_database:term\_in\_the\_export\_file\\
\hline
\end{tabular}
\paragraph{Referenced by}
translator\_id: col.dataset\_column (translator\_id)

\subsubsection{Views}
\paragraph{last\_borrowing}
 SELECT b1.borrowing\_id,
    b1.uid,
    b1.borrowing\_date,
    b1.expected\_return\_date,
    b1.borrower\_id
   FROM col.borrowing b1
  WHERE (b1.borrowing\_id = ( SELECT b2.borrowing\_id
           FROM col.borrowing b2
          WHERE ((b1.uid = b2.uid) AND (b2.return\_date IS NULL))
          ORDER BY b2.borrowing\_date DESC
         LIMIT 1));

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type \\
\hline
borrowing\_id & integer\\
uid & integer\\
borrowing\_date & timestamp without time zone\\
expected\_return\_date & timestamp without time zone\\
borrower\_id & integer\\
\hline
\end{tabular}
\paragraph{last\_movement}
 SELECT s.uid,
    s.movement\_id,
    s.movement\_date,
    s.movement\_type\_id,
    s.container\_id,
    c.uid AS container\_uid,
    s.line\_number,
    s.column\_number,
    s.movement\_reason\_id
   FROM (col.movement s
     LEFT JOIN col.container c USING (container\_id))
  WHERE (s.movement\_id = ( SELECT st.movement\_id
           FROM col.movement st
          WHERE (s.uid = st.uid)
          ORDER BY st.movement\_date DESC
         LIMIT 1));

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type \\
\hline
uid & integer\\
movement\_id & integer\\
movement\_date & timestamp without time zone\\
movement\_type\_id & integer\\
container\_id & integer\\
container\_uid & integer\\
line\_number & integer\\
column\_number & integer\\
movement\_reason\_id & integer\\
\hline
\end{tabular}
\paragraph{last\_photo}
 SELECT d.document\_id,
    d.uid
   FROM col.document d
  WHERE (d.document\_id = ( SELECT d1.document\_id
           FROM col.document d1
          WHERE ((d1.mime\_type\_id = ANY (ARRAY[4, 5, 6])) AND (d.uid = d1.uid))
          ORDER BY d1.document\_creation\_date DESC, d1.document\_import\_date DESC, d1.document\_id DESC
         LIMIT 1));

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type \\
\hline
document\_id & integer\\
uid & integer\\
\hline
\end{tabular}
\paragraph{slots\_used}
 SELECT last\_movement.container\_id,
    count(*) AS nb\_slots\_used
   FROM col.last\_movement
  WHERE (last\_movement.movement\_type\_id = 1)
  GROUP BY last\_movement.container\_id;

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type \\
\hline
container\_id & integer\\
nb\_slots\_used & bigint\\
\hline
\end{tabular}
\paragraph{v\_object\_identifier}
 SELECT object\_identifier.uid,
    array\_to\_string(array\_agg((((
        CASE
            WHEN (identifier\_type.identifier\_type\_code IS NOT NULL) THEN identifier\_type.identifier\_type\_code
            ELSE identifier\_type.identifier\_type\_name
        END)::text || ':'::text) || (object\_identifier.object\_identifier\_value)::text) ORDER BY identifier\_type.identifier\_type\_code, object\_identifier.object\_identifier\_value), ','::text) AS identifiers
   FROM (col.object\_identifier
     JOIN col.identifier\_type USING (identifier\_type\_id))
  GROUP BY object\_identifier.uid
  ORDER BY object\_identifier.uid;

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type \\
\hline
uid & integer\\
identifiers & text\\
\hline
\end{tabular}
\paragraph{v\_subsample\_quantity}
 SELECT s.sample\_id,
    s.uid,
    s.multiple\_value,
    COALESCE(( SELECT sum(smore.subsample\_quantity) AS sum
           FROM col.subsample smore
          WHERE ((smore.movement\_type\_id = 1) AND (smore.sample\_id = s.sample\_id))), (0)::double precision) AS subsample\_more,
    COALESCE(( SELECT sum(sless.subsample\_quantity) AS sum
           FROM col.subsample sless
          WHERE ((sless.movement\_type\_id = 2) AND (sless.sample\_id = s.sample\_id))), (0)::double precision) AS subsample\_less
   FROM col.sample s;

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type \\
\hline
sample\_id & integer\\
uid & integer\\
multiple\_value & double precision\\
subsample\_more & double precision\\
subsample\_less & double precision\\
\hline
\end{tabular}
\subsection{Schema gacl}
\subsubsection{Tables}
\paragraph{aclacl}
Table of rights granted

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type & Not null & Key & Comment \\
\hline
aclaco\_id & integer & X & X & \\
aclgroup\_id & integer & X & X & \\
\hline
\end{tabular}
\paragraph{References}
aclaco\_id: gacl.aclaco (aclaco\_id)

aclgroup\_id: gacl.aclgroup (aclgroup\_id)

\paragraph{aclaco}
Table of managed rights

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type & Not null & Key & Comment \\
\hline
aclaco\_id & integer & X & X & \\
aclappli\_id & integer & X &  & \\
aco & character varying & X &  & Name of the right in the application\\
\hline
\end{tabular}
\paragraph{References}
aclappli\_id: gacl.aclappli (aclappli\_id)

\paragraph{Referenced by}
aclaco\_id: gacl.aclacl (aclaco\_id)

\paragraph{aclappli}
Table of managed applications

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type & Not null & Key & Comment \\
\hline
aclappli\_id & integer & X & X & \\
appli & character varying & X &  & Code of the application used to manage the rights\\
applidetail & character varying &  &  & Description of the application\\
\hline
\end{tabular}
\paragraph{Referenced by}
aclappli\_id: gacl.aclaco (aclappli\_id)

\paragraph{aclgroup}
Groups of logins

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type & Not null & Key & Comment \\
\hline
aclgroup\_id & integer & X & X & \\
groupe & character varying & X &  & Name of the group\\
aclgroup\_id\_parent & integer &  &  & Parent group who inherits of the rights attributed to this group\\
\hline
\end{tabular}
\paragraph{References}
aclgroup\_id\_parent: gacl.aclgroup (aclgroup\_id)

\paragraph{Referenced by}
aclgroup\_id: gacl.aclacl (aclgroup\_id)

aclgroup\_id: gacl.aclgroup (aclgroup\_id\_parent)

aclgroup\_id: gacl.acllogingroup (aclgroup\_id)

aclgroup\_id: col.collection\_group (aclgroup\_id)

\paragraph{acllogin}
List of logins granted to access to the modules of the application

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type & Not null & Key & Comment \\
\hline
acllogin\_id & integer & X & X & \\
login & character varying & X &  & Login. It must be the same as the table logingestion\\
logindetail & character varying & X &  & Displayed name\\
totp\_key & character varying &  &  & TOTP secret key for the user\\
\hline
\end{tabular}
\paragraph{Referenced by}
acllogin\_id: gacl.acllogingroup (acllogin\_id)

\paragraph{acllogingroup}
List of logins in the groups

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type & Not null & Key & Comment \\
\hline
acllogin\_id & integer & X & X & \\
aclgroup\_id & integer & X & X & \\
\hline
\end{tabular}
\paragraph{References}
aclgroup\_id: gacl.aclgroup (aclgroup\_id)

acllogin\_id: gacl.acllogin (acllogin\_id)

\paragraph{log}
List of all recorded operations (logins, calls of modules, etc.)

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type & Not null & Key & Comment \\
\hline
log\_id & integer & X & X & \\
login & character varying(32) & X &  & Code of the login who performs the operation\\
nom\_module & character varying &  &  & Name of the performed module\\
log\_date & timestamp without time zone & X &  & Date-time of the operation\\
commentaire & character varying &  &  & Complementary data recorded\\
ipaddress & character varying &  &  & IP address of the client\\
\hline
\end{tabular}
\paragraph{logingestion}
List of logins used to connect to the application, when the account is managed by the application itself. This table also contains the accounts authorized to use the web services.

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type & Not null & Key & Comment \\
\hline
id & integer & X & X & \\
login & character varying & X &  & Login used by the user\\
password & character varying &  &  & \\
nom & character varying &  &  & Name of the user\\
prenom & character varying &  &  & Surname\\
mail & character varying(255) &  &  & email. Used to send password loss messages\\
datemodif & timestamp without time zone &  &  & Last date of change of the record\\
actif & smallint &  &  & If 1, the account is active and can be logging to the application\\
is\_clientws & boolean &  &  & True if the login is used by a third-party application to call a web-service\\
tokenws & character varying &  &  & Identification token used for the third-parties applications\\
is\_expired & boolean &  &  & If true, the account is expired (password older)\\
\hline
\end{tabular}
\paragraph{Referenced by}
id: gacl.passwordlost (id)

\paragraph{passwordlost}
Password loss tracking table

\begin{tabular}{|l| p{2cm}|c|c| p{5cm}|}
\hline
Column name & Type & Not null & Key & Comment \\
\hline
passwordlost\_id & integer & X & X & \\
id & integer & X &  & Logingestion id key\\
token & character varying & X &  & Token used to renewal\\
expiration & timestamp without time zone & X &  & Expiration date-time of the token\\
usedate & timestamp without time zone &  &  & Used date-time of the token\\
\hline
\end{tabular}
\paragraph{References}
id: gacl.logingestion (id)


